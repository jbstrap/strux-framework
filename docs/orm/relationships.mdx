---
title: Relationships
sidebar_position: 2
---

# ORM Relationships

Strux ORM relationships are defined **on model properties**, not methods.

:::info
Relationships are resolved dynamically via `__call()` and support lazy and eager loading.
:::

---

## Relationship Types

Strux supports:

- One-to-Many (`HasMany`)
- Many-to-One (`BelongsTo`)
- Many-to-Many (`BelongsToMany`)

---

## One-to-Many (HasMany)

```php
use Strux\Component\Model\Attributes\HasMany;
use Strux\Support\Collection;

#[HasMany(related: Comment::class, foreignKey: 'postID')]
public Collection $comments;
````

---

## Many-to-One (BelongsTo)

```php
use Strux\Component\Model\Attributes\BelongsTo;

#[BelongsTo(related: User::class, foreignKey: 'userID')]
public ?User $author = null;
```

---

## Many-to-Many (BelongsToMany)

```php
use Strux\Component\Model\Attributes\BelongsToMany;

#[BelongsToMany(
    related: Tag::class,
    pivotTable: 'post_tags',
    foreignPivotKey: 'post_id',
    relatedPivotKey: 'tag_id'
)]
public Collection $tags;
```

---

## Accessing Relationships

### Lazy Loading

```php
$post = Post::find(1);

foreach ($post->comments as $comment) {
    // ...
}
```

---

### Eager Loading

```php
$posts = Post::query()
    ->with('comments', 'author')
    ->get();
```

---

## Relationship Ordering

```php
use Strux\Component\Database\Attributes\OrderBy;

#[OrderBy('createdAt', 'DESC')]
public Collection $comments;
```